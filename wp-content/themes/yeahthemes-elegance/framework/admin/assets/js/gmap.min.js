!function(t){"use strict";var e=function(t){this.$container=t};e.prototype={init:function(){this.initDomElements(),this.initMapElements(),this.initMarkerPosition(),this.addListeners(),this.autocomplete()},initDomElements:function(){this.canvas=this.$container.find(".yt-map-canvas")[0],this.$coordinate=this.$container.find(".yt-map-coordinate"),this.$findButton=this.$container.find(".yt-map-goto-address"),this.addressField=this.$findButton.val()},initMapElements:function(){var e,o=t(this.canvas).data("default-loc");o=o?o.split(","):[53.346881,-6.25886],e=new google.maps.LatLng(o[0],o[1]),this.map=new google.maps.Map(this.canvas,{center:e,zoom:14,streetViewControl:0,mapTypeId:google.maps.MapTypeId.ROADMAP}),this.marker=new google.maps.Marker({position:e,map:this.map,draggable:!0}),this.geocoder=new google.maps.Geocoder},initMarkerPosition:function(){var t,e,o=this.$coordinate.val();o?(t=o.split(","),this.marker.setPosition(new google.maps.LatLng(t[0],t[1])),e=t.length>2?parseInt(t[2],10):14,this.map.setCenter(this.marker.position),this.map.setZoom(e)):this.addressField&&this.geocodeAddress()},addListeners:function(){var t=this;google.maps.event.addListener(this.map,"click",function(e){t.marker.setPosition(e.latLng),t.updateCoordinate(e.latLng)}),google.maps.event.addListener(this.marker,"drag",function(e){t.updateCoordinate(e.latLng)}),this.$findButton.on("click",function(){return t.geocodeAddress(),!1})},autocomplete:function(){var e=this;!this.addressField||this.addressField.split(",").length>1||t("#"+this.addressField).autocomplete({source:function(o,i){e.geocoder.geocode({address:o.term},function(e){i(t.map(e,function(t){return{label:t.formatted_address,value:t.formatted_address,latitude:t.geometry.location.lat(),longitude:t.geometry.location.lng()}}))})},select:function(t,o){var i=new google.maps.LatLng(o.item.latitude,o.item.longitude);e.map.setCenter(i),e.marker.setPosition(i),e.updateCoordinate(i)}})},updateCoordinate:function(t){this.$coordinate.val(t.lat()+","+t.lng())},geocodeAddress:function(){var t,e="",o=new Array,i=this.addressField.split(","),n=this;for(t=0;t<i.length;t++)o[t]=jQuery("#"+i[t]).val();e=o.join(",").replace(/\n/g,",").replace(/,,/g,","),e&&this.geocoder.geocode({address:e},function(t,e){e===google.maps.GeocoderStatus.OK&&(n.map.setCenter(t[0].geometry.location),n.marker.setPosition(t[0].geometry.location),n.updateCoordinate(t[0].geometry.location))})}},t(function(){t(".yt-map-field").each(function(){var o=new e(t(this));o.init(),t(this).data("mapController",o)})})}(jQuery);